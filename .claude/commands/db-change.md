---
description: DBスキーマ変更の手順をガイドします
---

データベーススキーマの変更を安全に実施するための手順をガイドします。

## スキーマ変更の手順

### 1. スキーマ定義の変更

`apps/web/src/server/db/schema.ts` を編集してください。

**注意点:**
- テーブル名・カラム名はスネークケース
- 型エクスポート（`$inferSelect`, `$inferInsert`）を忘れない
- リレーションを適切に定義

### 2. スキーマの適用

```bash
# 開発環境
pnpm db:push

# 本番環境（マイグレーション）
pnpm db:generate  # マイグレーションファイル生成
pnpm db:migrate   # マイグレーション実行
```

### 3. 型定義の更新

TypeScriptの型が自動的に更新されます。
IDEのTypeScriptサーバーを再起動してください。

### 4. アプリケーションコードの更新

変更に応じてアプリケーションコードを更新してください：
- tRPCルーターのクエリ/ミューテーション
- コンポーネントでの型使用
- バリデーションスキーマ（Zod）

### 5. テストの実行

```bash
pnpm test
pnpm lint:fix
```

## 変更内容の確認

現在のスキーマ変更の内容を説明してください：
- 追加/変更/削除したテーブル
- 追加/変更/削除したカラム
- リレーションの変更

その後、上記の手順に従って変更を適用してください。
