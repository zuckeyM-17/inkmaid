# ğŸ“ Inkmaid

**æ‰‹æ›¸ãã¨AIã§ç›´æ„Ÿçš„ã«å›³è§£ã™ã‚‹ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **

ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§ã®ã€Œæ‰‹æ›¸ãã€ã¨ã„ã†ç›´æ„Ÿçš„ãªå…¥åŠ›ã¨ã€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ã‚ˆã‚‹ã€Œè«–ç†çš„ãªæ§‹é€ æ“ä½œã€ã‚’èåˆã•ã›ã€å°‚é–€çŸ¥è­˜ãŒãªãã¦ã‚‚é«˜åº¦ãªMermaidå›³ï¼ˆãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã€ERå›³ã€ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ç­‰ï¼‰ã‚’å³åº§ã«ä½œæˆãƒ»ç·¨é›†ãƒ»ç®¡ç†ã§ãã‚‹ç’°å¢ƒã‚’æä¾›ã—ã¾ã™ã€‚

---

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### å‰ææ¡ä»¶

ä»¥ä¸‹ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

- **Node.js** >= 20.0.0
- **pnpm** >= 9.15.1
- **Docker** & **Docker Compose**

```bash
# pnpmãŒãªã„å ´åˆã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
corepack enable && corepack prepare pnpm@9.15.1 --activate
```

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# 1. ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone <repository-url>
cd inkmaid

# 2. ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pnpm install

# 3. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
cp .env.example .env

# 4. (Cursor AIä½¿ç”¨æ™‚ã®ã¿) pnpmã‚¹ãƒˆã‚¢è¨­å®š
cp .npmrc.example .npmrc
# .npmrc ã‚’ç·¨é›†ã—ã¦ YOUR_USERNAME ã‚’è‡ªåˆ†ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã«å¤‰æ›´

# 5. é–‹ç™ºç’°å¢ƒã‚’èµ·å‹•ï¼ˆDB + Next.jsï¼‰
pnpm dev:all
```

> **Note**: Cursor AI ã®ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ç’°å¢ƒã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€æ‰‹é †4ã® `.npmrc` è¨­å®šãŒå¿…è¦ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Š pnpm ã®ã‚¹ãƒˆã‚¢ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸ä¸€è‡´ã‚¨ãƒ©ãƒ¼ã‚’é˜²ãã¾ã™ã€‚

ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:3000 ã‚’é–‹ãã¨ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

---

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ã‚«ãƒ†ã‚´ãƒª | æŠ€è¡“ | èª¬æ˜ |
|---------|------|------|
| **Framework** | Next.js 15 (App Router) | ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯Reactãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| **Language** | TypeScript 5 | å‹å®‰å…¨ãªé–‹ç™º |
| **Styling** | Tailwind CSS 4 | ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆCSS |
| **API** | tRPC | å‹å®‰å…¨ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ/ã‚µãƒ¼ãƒãƒ¼é€šä¿¡ |
| **Database** | PostgreSQL 16 | ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ |
| **ORM** | Drizzle ORM | TypeScriptãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªORM |
| **AI** | Vercel AI SDK | LLMã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ»Tool Calling |
| **Linter** | Biome | é«˜é€ŸãªLinter/Formatter (Rustè£½) |
| **Testing** | Vitest | é«˜é€Ÿãªãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ |
| **Package Manager** | pnpm | åŠ¹ç‡çš„ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç† |
| **Container** | Docker Compose | é–‹ç™º/æœ¬ç•ªç’°å¢ƒã®çµ±ä¸€ |

---

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
.
â”œâ”€â”€ apps/
â”‚   â””â”€â”€ web/                      # Next.js ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ app/              # App Router ãƒšãƒ¼ã‚¸
â”‚       â”‚   â”‚   â”œâ”€â”€ api/trpc/     # tRPC APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚       â”‚   â”‚   â”œâ”€â”€ layout.tsx    # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚       â”‚   â”‚   â””â”€â”€ page.tsx      # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸
â”‚       â”‚   â”œâ”€â”€ components/       # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆä»Šå¾Œè¿½åŠ ï¼‰
â”‚       â”‚   â”œâ”€â”€ lib/
â”‚       â”‚   â”‚   â””â”€â”€ trpc/         # tRPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®š
â”‚       â”‚   â””â”€â”€ server/
â”‚       â”‚       â”œâ”€â”€ db/           # Drizzle ã‚¹ã‚­ãƒ¼ãƒãƒ»ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚       â”‚       â””â”€â”€ trpc/         # tRPC ãƒ«ãƒ¼ã‚¿ãƒ¼å®šç¾©
â”‚       â”œâ”€â”€ drizzle.config.ts     # Drizzleè¨­å®š
â”‚       â”œâ”€â”€ Dockerfile            # æœ¬ç•ªç”¨Dockerfile
â”‚       â””â”€â”€ package.json
â”œâ”€â”€ doc/                          # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ develop.md                # è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â””â”€â”€ 2025-12-21.md             # é–‹ç™ºãƒ­ã‚°
â”œâ”€â”€ docker-compose.yml            # é–‹ç™ºç”¨ï¼ˆPostgreSQLã®ã¿ï¼‰
â”œâ”€â”€ docker-compose.prod.yml       # æœ¬ç•ªç”¨ï¼ˆPostgreSQL + Webï¼‰
â”œâ”€â”€ biome.json                    # Biomeè¨­å®š
â”œâ”€â”€ pnpm-workspace.yaml           # pnpmãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹è¨­å®š
â””â”€â”€ package.json                  # ãƒ«ãƒ¼ãƒˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¨­å®š
```

---

## ğŸ“‹ ã‚³ãƒãƒ³ãƒ‰ä¸€è¦§

### é–‹ç™º

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `pnpm dev` | Next.jsé–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹• |
| `pnpm dev:all` | DBèµ·å‹• â†’ Next.jsèµ·å‹•ï¼ˆæ¨å¥¨ï¼‰ |
| `pnpm build` | ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰ |
| `pnpm start` | ãƒ“ãƒ«ãƒ‰æ¸ˆã¿ã‚¢ãƒ—ãƒªã‚’èµ·å‹• |

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `pnpm db:up` | PostgreSQLã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹• |
| `pnpm db:down` | PostgreSQLã‚³ãƒ³ãƒ†ãƒŠã‚’åœæ­¢ |
| `pnpm db:logs` | PostgreSQLã®ãƒ­ã‚°ã‚’è¡¨ç¤º |
| `pnpm db:reset` | ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¦å†èµ·å‹• |
| `pnpm db:push` | ã‚¹ã‚­ãƒ¼ãƒã‚’DBã«åæ˜  |
| `pnpm db:generate` | ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ |
| `pnpm db:migrate` | ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ |
| `pnpm db:studio` | Drizzle Studioï¼ˆDB GUIï¼‰ã‚’èµ·å‹• |

### ã‚³ãƒ¼ãƒ‰å“è³ª

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `pnpm lint` | Biomeã§ã‚³ãƒ¼ãƒ‰ã‚’ãƒã‚§ãƒƒã‚¯ |
| `pnpm lint:fix` | å•é¡Œã‚’è‡ªå‹•ä¿®æ­£ |
| `pnpm format` | ã‚³ãƒ¼ãƒ‰ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ |
| `pnpm test` | Vitestã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ |

### æœ¬ç•ªç’°å¢ƒ

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `pnpm prod:build` | æœ¬ç•ªç”¨Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ |
| `pnpm prod:up` | æœ¬ç•ªç’°å¢ƒã‚’èµ·å‹•ï¼ˆDB + Webï¼‰ |
| `pnpm prod:down` | æœ¬ç•ªç’°å¢ƒã‚’åœæ­¢ |
| `pnpm prod:logs` | æœ¬ç•ªç’°å¢ƒã®ãƒ­ã‚°ã‚’è¡¨ç¤º |

---

## ğŸ”§ é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

### 1. æ—¥å¸¸çš„ãªé–‹ç™º

```bash
# é–‹ç™ºç’°å¢ƒã‚’èµ·å‹•
pnpm dev:all

# http://localhost:3000 ã§é–‹ç™º
# ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã™ã‚‹ã¨ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã™
```

### 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã®å¤‰æ›´

```bash
# 1. apps/web/src/server/db/schema.ts ã‚’ç·¨é›†

# 2. ã‚¹ã‚­ãƒ¼ãƒã‚’DBã«åæ˜ 
pnpm db:push

# ã¾ãŸã¯ã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ
pnpm db:generate
pnpm db:migrate
```

### 3. ã‚³ãƒŸãƒƒãƒˆå‰ã®ãƒã‚§ãƒƒã‚¯

```bash
# Lintã¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
pnpm lint:fix

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
pnpm test
```

### 4. æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã®ç¢ºèª

```bash
# æœ¬ç•ªç’°å¢ƒã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§èµ·å‹•
pnpm prod:build
pnpm prod:up

# http://localhost:3000 ã§ç¢ºèª
```

---

## ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹æˆ

### ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§

| ãƒ†ãƒ¼ãƒ–ãƒ« | èª¬æ˜ |
|---------|------|
| `projects` | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆå›³ï¼‰ã®åŸºæœ¬æƒ…å ± |
| `diagram_versions` | Mermaidã‚³ãƒ¼ãƒ‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´ |
| `chat_sessions` | AIã¨ã®å¯¾è©±ã‚»ãƒƒã‚·ãƒ§ãƒ³ |
| `chat_messages` | ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å±¥æ­´ |
| `handwriting_strokes` | æ‰‹æ›¸ãã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ãƒ‡ãƒ¼ã‚¿ |

### æ¥ç¶šæƒ…å ±ï¼ˆé–‹ç™ºç’°å¢ƒï¼‰

| é …ç›® | å€¤ |
|-----|-----|
| Host | localhost |
| Port | 5432 |
| User | inkmaid |
| Password | inkmaid_password |
| Database | inkmaid |

---

## ğŸ”Œ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

tRPCã‚’ä½¿ç”¨ã—ãŸå‹å®‰å…¨ãªAPIã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

### diagram ãƒ«ãƒ¼ã‚¿ãƒ¼

| ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | ãƒ¡ã‚½ãƒƒãƒ‰ | èª¬æ˜ |
|---------------|---------|------|
| `diagram.listProjects` | Query | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ã‚’å–å¾— |
| `diagram.createProject` | Mutation | æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ |
| `diagram.getProject` | Query | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè©³ç´°ã‚’å–å¾— |
| `diagram.getVersionHistory` | Query | ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´ã‚’å–å¾— |
| `diagram.saveVersion` | Mutation | æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä¿å­˜ |

### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ã®ä½¿ç”¨ä¾‹

```tsx
import { trpc } from "@/lib/trpc/client";

// ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ã‚’å–å¾—
const { data: projects } = trpc.diagram.listProjects.useQuery();

// ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
const createProject = trpc.diagram.createProject.useMutation();
createProject.mutate({ name: "My Diagram" });
```

---

## â“ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒãƒ¼ãƒˆ3000ãŒä½¿ç”¨ä¸­

```bash
# ä½¿ç”¨ä¸­ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç¢ºèª
lsof -i :3000

# ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†
kill -9 <PID>
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼

```bash
# PostgreSQLãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
pnpm db:logs

# ã‚³ãƒ³ãƒ†ãƒŠã‚’å†èµ·å‹•
pnpm db:restart
```

### node_modulesã®å•é¡Œ

```bash
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã¦å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
rm -rf node_modules apps/web/node_modules
pnpm install
```

### Drizzleã®ã‚¹ã‚­ãƒ¼ãƒåŒæœŸ

```bash
# ã‚¹ã‚­ãƒ¼ãƒã‚’å¼·åˆ¶çš„ã«å†é©ç”¨
DATABASE_URL="postgresql://inkmaid:inkmaid_password@localhost:5432/inkmaid" pnpm db:push
```

---

## ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](./doc/develop.md) - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è©³ç´°è¨­è¨ˆ
- [é–‹ç™ºãƒ­ã‚°](./doc/logs/) - æ—¥ã€…ã®é–‹ç™ºè¨˜éŒ²ï¼ˆ`yyyymmdd.md` å½¢å¼ï¼‰

---

## ğŸ—ºï¸ ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### Phase 1: åŸºç›¤æ§‹ç¯‰ âœ…

- [x] pnpm ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- [x] Docker + PostgreSQL ç’°å¢ƒ
- [x] Drizzle ORM ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
- [x] tRPC API åŸºç›¤

### Phase 2: ã‚³ã‚¢æ©Ÿèƒ½ã®å®Ÿè£…

- [ ] æ‰‹æ›¸ãCanvasï¼ˆKonva.jsï¼‰
- [ ] Mermaid.js ã«ã‚ˆã‚‹å›³ã®æç”»
- [ ] Vercel AI SDK ã«ã‚ˆã‚‹ AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ

### Phase 3: é«˜åº¦ãªç·¨é›†ã¨æœ€é©åŒ–

- [ ] æ‰‹æ›¸ãã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼èªè­˜
- [ ] ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´ã®ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒ™ãƒ«UI
- [ ] ãƒ†ã‚¹ãƒˆã®å……å®Ÿ

---

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

1. æ©Ÿèƒ½ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ: `git checkout -b feature/amazing-feature`
2. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ: `git commit -m 'Add amazing feature'`
3. ãƒ–ãƒ©ãƒ³ãƒã‚’ãƒ—ãƒƒã‚·ãƒ¥: `git push origin feature/amazing-feature`
4. ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆ

---

## ğŸ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ [MIT License](./LICENSE) ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

