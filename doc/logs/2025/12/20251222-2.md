# 開発ログ 2025-12-22 #2

## 実装内容

### 1. プロジェクトアーカイブ機能
プロジェクトを完全削除ではなくアーカイブする機能を実装しました。

**スキーマ変更**:
- `projects`テーブルに`archivedAt`カラムを追加
- `null`の場合はアクティブ、日時が入っている場合はアーカイブ済み

**API**:
- `diagram.archiveProject` - プロジェクトをアーカイブ
- `diagram.unarchiveProject` - アーカイブを解除して復元
- `diagram.listArchivedProjects` - アーカイブ済み一覧を取得
- `diagram.listProjects` - アクティブなプロジェクトのみ返すように変更

**UI**:
- プロジェクトカードにホバー時にアーカイブボタン（📦アイコン）を表示
- アーカイブ済みプロジェクトセクションを折りたたみ表示
- 復元ボタン（↻アイコン）でワンクリック復元

### 2. プロジェクトごとのURL対応
プロジェクトを選択するとURLが `/projects/[id]` に変わるようになりました。

**変更点**:
- `/` (トップページ): プロジェクト一覧のみを表示
- `/projects/[id]`: プロジェクト詳細・編集ページ

**メリット**:
- ブックマークやURL共有が可能
- ブラウザの戻る/進むボタンが正しく動作
- リロード時も同じプロジェクトが表示される

---

## 追加・変更したファイル

### 新規作成
- `apps/web/src/app/projects/[id]/page.tsx` - プロジェクト詳細ページ

### 変更
- `apps/web/src/server/db/schema.ts` - `archivedAt`カラム追加
- `apps/web/src/server/trpc/routers/diagram.ts` - アーカイブ関連API追加
- `apps/web/src/app/page.tsx` - アーカイブUI実装
- `apps/web/drizzle.config.ts` - `.env.local`を読み込むよう修正（dotenv追加）
- `doc/api-reference.md` - API ドキュメント更新
- `doc/TODO.md` - 完了タスクを更新

---

## DBマイグレーション

スキーマを変更したため、以下を実行してください：

```bash
pnpm db:push
```

---

## 次のステップ

優先度高:
- プロジェクトの名前変更機能
- キャンバスのズーム・パン操作

中優先度:
- Langfuse導入（LLMモニタリング）
- バージョン履歴機能
